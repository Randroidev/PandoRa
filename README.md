[![en](https://img.shields.io/badge/lang-en-blue.svg)](https://github.com/Randroidev/PandoRa/blob/master/README.en.md)
[![ru](https://img.shields.io/badge/lang-ru-red.svg)](https://github.com/Randroidev/PandoRa/blob/master/README.md)

# PandoRa
**Data Visualization App**
PandoRa — это инструмент для визуализации данных, разработанный для анализа параметров аккумуляторов и других временных рядов. Поддерживает числовые, процентные и логические данные (флаги состояния и процессов), автоматически синхронизирует графики и позволяет гибко настраивать отображаемые столбцы.

Например:

|                     | Voltage | Current | WEAR % | FD    | FC    | RCA   | F-CH | F-DCH |
|---------------------|---------|---------|--------|-------|-------|-------|------|-------|
| 2025-01-23 10:00:00 | 9000    | 3000    | 0      | TRUE  | FALSE | TRUE  | 1    | 0     |
| 2025-01-23 11:00:00 | 10350   | 2025    | 10     | FALSE | FALSE | FALSE | 1    | 0     |
| 2025-01-23 11:00:00 | 12600   | 0       | 30     | FALSE | TRUE  | FALSE | 0    | 0     |
| 2025-01-23 12:00:00 | 18070   | -1750   | 100    | FALSE | FALSE | FALSE | 0    | 1     |
| 2025-01-23 13:00:00 | 9000    | 0       | 90     | TRUE  | FALSE | TRUE  | 0    | 0     |

В этой таблице собран датасет смешанных данных - числовые параметры, процентные значения, логические флаги состояния и флаги процесса.
Такие данные могут быть визуализированы на одном графике с синхронизацией масштабирования и скроллинга для удобства анализа при помощи приложения **PandoRa**.
![](https://github.com/Randroidev/PandoRa/blob/master/images/_DemoGenBatt.png)

## Типы данных
### Timestamp
Временная метка хранится в первом столбце.
### Numeric
Численные данные отображаются на основном графике со шкалой слева.
### Percent
Процентные данные отображаются на основном графике со шкалой справа.
Название столбца процентных данных должен содержать знак процента `%`.
### State Flag
Флаги состояния отображаются в виде флагов в верхней части полотна.
Формат данных для флагов состояния - `BOOLEAN`.
### Process Flag
Флаги процесса отображаются в виде закраски фона на основном графике.
Названия столбцов флагов процесса должны начинаться с `F-`.

Прочие данные воспринимаются, как численные и будут отображаться в виде графиков.

## Парсер данных
Парсер основан на [Pandas](https://pandas.pydata.org/about/index.html) и поддерживает следующие типы файлов:
- `.xls` (Excel 97-2003)
- `.xlsx` (Excel 2007 и позже)
- `.xlsm` (Excel 2007 и позже с макросами)
- `.xlsb` (Excel 2007 и позже в бинарном формате)
- `.odf` (OpenDocument Format)
- `.ods` (OpenDocument Spreadsheet)

## Командная строка
При старте PandoRa ожидает имя файла в командной строке. 
Если файл не указан в аргументах командной строки или к нему нет доступа, то программа пробует открыть в текущей директории файл `data.xls`. 
Если файла нет, то программа выводит диалоговое окно для выбора файла.

## Генерация демо-данных
Предусмотрена генерация демонстрационных данных по ключам:
-    `--demo 300 6` - генерация 300 точек с 8 случайными сигналами
-    `--demo batt` - генерация датасета трёх циков заряд-разряд батареи с частотой опроса каждые 10 секунд, что даёт 11881 точек за 33 часа.
На время выполнения демо-генерации программа создает временный файл `pandora_demo.xlsx` в текущей директории в демонстрационных целях.
![](https://github.com/Randroidev/PandoRa/blob/master/images/_DemoGenRand.png)

## Особенности работы и GUI
Приложение написано на Python с использованием библиотек [tkinter](https://docs.python.org/3/library/tkinter.html) и [matplotlib](https://matplotlib.org/).
Интерфейс приложения может притормаживать во время прорисовки графиков, особенно с использованием больших датасетов. 
Внезапно интерфейс в тёмной теме тупит больше, чем в светлой.
Масштабирование и скроллинг осуществляется с зажатыми кнопками мышки.

### Выбор столбцов для отображения
В приложении предусмотренна возможность выбирать столбцы для отображения. 
Для этого достаточно отметить соответствующий чекбокс в окне `Column Settings`, которое вызывается кнопкой с галочкой.
Приложение автоматически предлагает исключить те столбцы, значения в которых не меняются на протяжении всего датасета.
![](https://github.com/Randroidev/PandoRa/blob/master/images/_ColumnSelector.png)

### G
Эта кнопка включает/выключает фон в графиках флагов состояния.

### T
Эта кнопка включает/выключает отображение меток времени, соответствующих точкам в датасете.
На больших датасетах может сильно тормозить и мешать визуальному восприятию.

### Theme
Приложение имеет темную и светлую тему.

### Масштабирование по флагам состояния
При клике по графику флагов состояния будет производится масштабирование графиков до границ области, по которой был сделан клик.

## Настройки
Приложение имеет гибкие настройки, которые можно изменить в файле `settings.ini` или в GUI. 
Настройки, отмеченные `[*]` корректно применяются после перезапуска приложения.
Если файл конфигурации отсутствует, то программа создаёт новый с параметрами поумолчанию.
![](https://github.com/Randroidev/PandoRa/blob/master/images/_Settings.png)

## Взаимодействие с KNN
[Взаимодействие с KNN](https://github.com/Randroidev/PandoRa/blob/master/KNN.md)
